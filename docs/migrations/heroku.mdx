---
title: "Migrate from Heroku Postgres to Xata"
description: "Learn how to migrate your Heroku Postgres database to Xata using xata clone. Step-by-step instructions for enabling logical replication and configuring the migration."
---

## Prerequisites

- Heroku Postgres add-on
- Heroku CLI installed
- Xata account and project setup
- Network access to your Heroku database

## Install and Configure the Xata CLI

Install the Xata CLI:

```bash
curl -fsSL https://xata.io/install.sh | bash
```

Authenticate with your Xata account:

```bash
xata auth login
```

## Get Connection String

### Find Your Connection Details

1. **Using Heroku CLI**:
   ```bash
   heroku config:get DATABASE_URL --app your-app-name
   ```

2. **Using Heroku Dashboard**:
   - Go to [Heroku Dashboard](https://dashboard.heroku.com)
   - Select your app
   - Go to "Resources" → "Heroku Postgres"
   - Click "Settings" → "View Credentials"

### Connection String Format

Heroku connection strings typically look like this:
```
postgresql://your_username:your_password@your-heroku-host:5432/your_database?sslmode=require
```

## Network Configuration

### Public Access

Heroku Postgres databases are typically accessible from the internet:

1. **No additional configuration** needed for public access
2. **SSL is required** by default
3. **Connection limits** may apply based on your plan

### Private Access (Premium Plans)

If you're on a Premium plan with private access:

1. **Use Heroku Private Spaces**
2. **Configure VPC peering** if needed
3. **Run migration from within Heroku** environment

## Replicate Database Roles

Before migrating your data, you'll need to replicate the database roles from your source database to your Xata branch.

### Extract Roles from Source Database

Connect to your source database and extract the role definitions:

```sql
-- Extract role definitions (run this on your source database)
SELECT 
    'CREATE ROLE ' || rolname || ' WITH ' ||
    CASE WHEN rolcanlogin THEN 'LOGIN ' ELSE 'NOLOGIN ' END ||
    CASE WHEN rolsuper THEN 'SUPERUSER ' ELSE 'NOSUPERUSER ' END ||
    CASE WHEN rolinherit THEN 'INHERIT ' ELSE 'NOINHERIT ' END ||
    CASE WHEN rolcreaterole THEN 'CREATEROLE ' ELSE 'NOCREATEROLE ' END ||
    CASE WHEN rolcreatedb THEN 'CREATEDB ' ELSE 'NOCREATEDB ' END ||
    CASE WHEN rolreplication THEN 'REPLICATION ' ELSE 'NOREPLICATION ' END ||
    CASE WHEN rolbypassrls THEN 'BYPASSRLS ' ELSE 'NOBYPASSRLS ' END ||
    'CONNECTION LIMIT ' || COALESCE(rolconnlimit, -1) || ';' as create_role_statement
FROM pg_roles 
WHERE rolname NOT LIKE 'pg_%'
ORDER BY rolname;
```

### Apply Roles to Xata Branch

1. **Connect to your Xata branch**:
   ```bash
   psql `xata branch url`
   ```

2. **Execute the role creation statements** from the previous step

## Initialize Xata Project

Set up your Xata project configuration:

```bash
xata init
```

## Configure the Migration

Set up your clone configuration with optional anonymization:

```bash
# Set your source URL
export XATA_CLI_SOURCE_POSTGRES_URL="postgresql://your_username:your_password@your-heroku-host:5432/your_database?sslmode=require"

# Configure anonymization rules
xata clone config --source-url $XATA_CLI_SOURCE_POSTGRES_URL --mode prompt
```

## Start the Migration

Begin the data transfer:

```bash
# Start the migration
xata clone start --source-url $XATA_CLI_SOURCE_POSTGRES_URL
```

## Monitor Progress

Check the migration status:

```bash
xata clone status
```

## Verification

After migration, verify your data:

1. **Connect to Xata Branch**:
   ```bash
   psql `xata branch url`
   ```

2. **Check Data Integrity**:
   ```sql
   -- Compare row counts
   SELECT COUNT(*) FROM your_table;
   
   -- Check sample data
   SELECT * FROM your_table LIMIT 10;
   ```

3. **Test Relationships**: Verify foreign key relationships work correctly

## Next Steps

- Explore [Xata branching](/core-concepts/branching) for development workflows
- Learn about [schema changes](/core-concepts/schema-changes) with zero downtime
- Set up [continuous sync](/tutorials/create-staging-replica) for ongoing replication
- Consider [deployment options](/deployment) for your Xata instance 