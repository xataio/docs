---
title: Data anonymization
description: Secure data handling with automatic PII detection and anonymization for development environments
---

Xata's data anonymization system automatically detects and masks sensitive information during database replication, enabling secure development and testing environments.

## PII detection

The system uses a combination of techniques to identify sensitive data:

1. **Column name analysis**: Detects common PII field names
2. **Pattern matching**: Identifies data formats (emails, phone numbers, etc.)
3. **Content analysis**: Examines data patterns and distributions
4. **Custom rules**: Supports user-defined detection rules

## Anonymization methods

Multiple anonymization strategies are available:

1. **Consistent hashing**: Same input produces same output
2. **Format preservation**: Maintains data structure and format
3. **Type safety**: Preserves data types and constraints
4. **Referential integrity**: Maintains relationships between tables

## Rule definition

Configure anonymization rules in your project:

```json
{
  "rules": {
    "email": {
      "type": "email",
      "preserve_domain": true
    },
    "phone": {
      "type": "phone",
      "preserve_country": true
    }
  }
}
```

## Custom transformers

Create custom anonymization functions:

```sql
CREATE FUNCTION anonymize_custom(value text)
RETURNS text AS $$
BEGIN
  -- Custom anonymization logic
  RETURN value;
END;
$$ LANGUAGE plpgsql;
```

## Integration points

### Replication pipeline

1. **Source connection**: Connect to production database
2. **Data extraction**: Read tables and columns
3. **Anonymization**: Apply rules during transfer
4. **Target loading**: Write to staging database

### CI/CD integration

```yaml
- name: Create anonymized branch
  run: xata branch create --anonymize
- name: Run tests
  run: npm test
```

## Security features

- **Deterministic anonymization**: Same input always produces same output
- **Format preservation**: Maintains data structure for testing
- **Relationship preservation**: Foreign keys remain valid
- **Type safety**: No data type violations

## Getting started

1. Configure detection rules:

```bash
xata config set detection.rules '{"email": "email", "phone": "phone"}'
```

2. Set up anonymization:

```bash
xata config set anonymization.enabled true
```

3. Create anonymized replica:
```bash
xata clone --anonymize
```

[Learn more about staging replicas](/core-concepts/staging) 